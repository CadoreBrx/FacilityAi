'use strict';const a0_0x510f09=a0_0x4d2b;(function(_0x38ed6e,_0x5704a6){const _0x5a673c=a0_0x4d2b,_0x33a585=_0x38ed6e();while(!![]){try{const _0x65bb73=-parseInt(_0x5a673c(0x24a))/0x1+parseInt(_0x5a673c(0x23b))/0x2*(-parseInt(_0x5a673c(0x219))/0x3)+parseInt(_0x5a673c(0x261))/0x4*(-parseInt(_0x5a673c(0x290))/0x5)+-parseInt(_0x5a673c(0x214))/0x6*(parseInt(_0x5a673c(0x238))/0x7)+-parseInt(_0x5a673c(0x1f8))/0x8*(parseInt(_0x5a673c(0x28f))/0x9)+parseInt(_0x5a673c(0x1e9))/0xa*(-parseInt(_0x5a673c(0x22a))/0xb)+-parseInt(_0x5a673c(0x1e6))/0xc*(-parseInt(_0x5a673c(0x270))/0xd);if(_0x65bb73===_0x5704a6)break;else _0x33a585['push'](_0x33a585['shift']());}catch(_0x5412a0){_0x33a585['push'](_0x33a585['shift']());}}}(a0_0x1070,0x7ff5d));var __create=Object[a0_0x510f09(0x24b)],__defProp=Object[a0_0x510f09(0x291)],__getOwnPropDesc=Object[a0_0x510f09(0x28a)],__getOwnPropNames=Object[a0_0x510f09(0x250)],__getProtoOf=Object[a0_0x510f09(0x21f)],__hasOwnProp=Object[a0_0x510f09(0x1e4)][a0_0x510f09(0x203)],__copyProps=(_0x253873,_0x4da50e,_0x65745e,_0x4a354b)=>{const _0x45b1d1=a0_0x510f09;if(_0x4da50e&&typeof _0x4da50e===_0x45b1d1(0x1e3)||typeof _0x4da50e==='function'){for(let _0x3a6ea6 of __getOwnPropNames(_0x4da50e))if(!__hasOwnProp['call'](_0x253873,_0x3a6ea6)&&_0x3a6ea6!==_0x65745e)__defProp(_0x253873,_0x3a6ea6,{'get':()=>_0x4da50e[_0x3a6ea6],'enumerable':!(_0x4a354b=__getOwnPropDesc(_0x4da50e,_0x3a6ea6))||_0x4a354b[_0x45b1d1(0x1fb)]});}return _0x253873;},__toESM=(_0x1f370d,_0x2f9fb2,_0x14d31a)=>(_0x14d31a=_0x1f370d!=null?__create(__getProtoOf(_0x1f370d)):{},__copyProps(_0x2f9fb2||!_0x1f370d||!_0x1f370d[a0_0x510f09(0x1e7)]?__defProp(_0x14d31a,'default',{'value':_0x1f370d,'enumerable':!![]}):_0x14d31a,_0x1f370d)),validateConfig=()=>{const _0x2ea3ba=a0_0x510f09;if(!process[_0x2ea3ba(0x1eb)][_0x2ea3ba(0x27a)])throw Error(_0x2ea3ba(0x283));if(process['env'][_0x2ea3ba(0x27a)]===_0x2ea3ba(0x242)&&!process[_0x2ea3ba(0x1eb)][_0x2ea3ba(0x260)])throw Error(_0x2ea3ba(0x255));if(process['env'][_0x2ea3ba(0x27a)]==='GPT'&&(!process['env'][_0x2ea3ba(0x1ed)]||!process[_0x2ea3ba(0x1eb)][_0x2ea3ba(0x25a)]))throw Error(_0x2ea3ba(0x289));},import_dotenv3=__toESM(require(a0_0x510f09(0x22b)),0x1),import_winston=__toESM(require('winston'),0x1),import_logging_winston=require(a0_0x510f09(0x20d)),import_os=__toESM(require('os'),0x1);function startLogging(){const _0x33efa6=a0_0x510f09,_0x2a0c2e=new import_logging_winston[(_0x33efa6(0x269))]({'projectId':'zap-gpt-417923','credentials':{'type':'service_account','project_id':_0x33efa6(0x223),'private_key_id':_0x33efa6(0x286),'private_key':_0x33efa6(0x23a),'client_email':'zap-gpt-public@zap-gpt-417923.iam.gserviceaccount.com','client_id':_0x33efa6(0x297),'universe_domain':_0x33efa6(0x213)}}),_0x5c271a=import_winston[_0x33efa6(0x205)]['createLogger']({'level':_0x33efa6(0x28e),'transports':[_0x2a0c2e]});console[_0x33efa6(0x29c)]=(..._0x121a2f)=>{const _0x3f96f9=_0x33efa6;console[_0x3f96f9(0x28e)](..._0x121a2f);const _0x252b11=_0x121a2f[_0x3f96f9(0x258)](_0x5959be=>typeof _0x5959be===_0x3f96f9(0x1e3)?JSON[_0x3f96f9(0x280)](_0x5959be):_0x5959be)[_0x3f96f9(0x1f3)]('\x20');_0x5c271a[_0x3f96f9(0x28e)](_0x252b11,{'computerId':import_os[_0x3f96f9(0x205)][_0x3f96f9(0x1f5)]()});};}var import_baileys4=require(a0_0x510f09(0x1e8)),import_node_cache=__toESM(require('node-cache'),0x1),import_baileys3=require(a0_0x510f09(0x1e8)),import_openai=__toESM(require(a0_0x510f09(0x23d)),0x1),import_dotenv=__toESM(require(a0_0x510f09(0x22b)),0x1),import_node_fs=__toESM(require('fs'),0x1),import_fluent_ffmpeg=__toESM(require(a0_0x510f09(0x27d)),0x1),import_ffmpeg=__toESM(require(a0_0x510f09(0x1df)),0x1);import_fluent_ffmpeg[a0_0x510f09(0x205)][a0_0x510f09(0x206)](import_ffmpeg[a0_0x510f09(0x205)]['path']),import_dotenv[a0_0x510f09(0x205)][a0_0x510f09(0x201)]();var assistant,openai,activeChats=new Map(),didInit=![];async function initializeNewAIChatSession(_0xd3416b){const _0x558819=a0_0x510f09;!didInit&&(openai=new import_openai[(_0x558819(0x205))]({'apiKey':process[_0x558819(0x1eb)][_0x558819(0x1ed)]}),assistant=await openai['beta'][_0x558819(0x208)][_0x558819(0x227)](process[_0x558819(0x1eb)]['OPENAI_ASSISTANT']),didInit=!![]);if(activeChats[_0x558819(0x21d)](_0xd3416b))return;const _0x3b95ed=await openai[_0x558819(0x256)]['threads']['create']();activeChats[_0x558819(0x293)](_0xd3416b,_0x3b95ed),setTimeout(()=>{const _0x1a2047=_0x558819;activeChats[_0x1a2047(0x21d)](_0xd3416b)&&(activeChats['delete'](_0xd3416b),console[_0x1a2047(0x29c)](_0x1a2047(0x288)+_0xd3416b+_0x1a2047(0x26f)));},0x48*0x3c*0x3c*0x3e8);}async function mainOpenAI({currentMessage:_0x3b561c,chatId:_0x5e18dd}){const _0x37f6ba=a0_0x510f09,_0x433715=activeChats[_0x37f6ba(0x235)](_0x5e18dd);await openai[_0x37f6ba(0x256)][_0x37f6ba(0x200)][_0x37f6ba(0x247)]['create'](_0x433715['id'],{'role':_0x37f6ba(0x226),'content':_0x3b561c});const _0x2b7fa2=await openai[_0x37f6ba(0x256)]['threads'][_0x37f6ba(0x26a)][_0x37f6ba(0x24b)](_0x433715['id'],{'assistant_id':assistant['id'],'instructions':assistant['instructions']}),_0x4e33c4=await checkRunStatus({'threadId':_0x433715['id'],'runId':_0x2b7fa2['id']}),_0x4c6597=_0x4e33c4['data'][0x0][_0x37f6ba(0x24d)][0x0];return _0x4c6597[_0x37f6ba(0x27f)]['value'];}async function checkRunStatus({threadId:_0x3a39d2,runId:_0x112b11}){return await new Promise((_0x4d9f94,_0x420920)=>{const _0x5798c2=async()=>{const _0x26933a=a0_0x4d2b;try{const _0x350793=await openai['beta'][_0x26933a(0x200)][_0x26933a(0x26a)][_0x26933a(0x227)](_0x3a39d2,_0x112b11);switch(_0x350793[_0x26933a(0x28b)]){case _0x26933a(0x259):{const _0x190174=await openai[_0x26933a(0x256)][_0x26933a(0x200)]['messages'][_0x26933a(0x22f)](_0x3a39d2);_0x4d9f94(_0x190174);break;}case _0x26933a(0x231):case _0x26933a(0x27c):console[_0x26933a(0x29c)](_0x26933a(0x222),_0x350793['status']),setTimeout(_0x5798c2,0x1388);break;case _0x26933a(0x20b):_0x420920(new Error('OpenAI\x20pediu\x20por\x20funções\x20que\x20não\x20estão\x20ativas\x20no\x20código\x20para\x20realizar.'));break;case'failed':case _0x26933a(0x1d9):case _0x26933a(0x1dc):case _0x26933a(0x241):console[_0x26933a(0x29c)]('runStatus.status:',_0x350793[_0x26933a(0x28b)]),_0x420920(new Error('Falha\x20ao\x20processar\x20a\x20mensagem\x20na\x20OpenAI.'));break;default:_0x420920(new Error(_0x26933a(0x1f7)));break;}}catch(_0x2f7f3b){console[_0x26933a(0x22d)](_0x26933a(0x287),_0x2f7f3b),_0x420920(_0x2f7f3b);}};_0x5798c2();});}async function convertAndTranscriptionAudio({bufferAudio:_0xe2ad33,messageId:_0x3a80e6}){return await new Promise((_0xcd1997,_0x3459e1)=>{const _0x450fac=a0_0x4d2b,_0x24a831='./input-audio-'+_0x3a80e6+_0x450fac(0x1fe),_0x5d69c4=_0x450fac(0x230)+_0x3a80e6+_0x450fac(0x284);import_node_fs[_0x450fac(0x205)]['writeFile'](_0x24a831,_0xe2ad33,{},()=>{const _0x4d9522=_0x450fac;(0x0,import_fluent_ffmpeg[_0x4d9522(0x205)])(_0x24a831)['toFormat'](_0x4d9522(0x278))['on'](_0x4d9522(0x22d),_0x5ee630=>{const _0xedd925=_0x4d9522;console[_0xedd925(0x22d)](_0xedd925(0x257),_0x5ee630),import_node_fs[_0xedd925(0x205)][_0xedd925(0x1f1)](_0x24a831,()=>{}),_0x3459e1(_0x5ee630);})['on'](_0x4d9522(0x23e),()=>{const _0x58a40f=_0x4d9522;console[_0x58a40f(0x29c)](_0x58a40f(0x25f)),openai[_0x58a40f(0x210)][_0x58a40f(0x1d8)][_0x58a40f(0x24b)]({'file':import_node_fs[_0x58a40f(0x205)][_0x58a40f(0x228)](_0x5d69c4),'model':_0x58a40f(0x29b),'language':'pt'})[_0x58a40f(0x252)](_0x48ec15=>{const _0x45dded=_0x58a40f;import_node_fs[_0x45dded(0x205)]['unlink'](_0x24a831,()=>{}),import_node_fs[_0x45dded(0x205)][_0x45dded(0x1f1)](_0x5d69c4,()=>{}),_0xcd1997(_0x48ec15[_0x45dded(0x27f)]);});})[_0x4d9522(0x240)](_0x5d69c4);});});}async function transcriptionImage({bufferImage:_0x5f2cf1,messageId:_0x26cc65,caption:_0x52ebc0}){return await new Promise((_0x5e1978,_0x51e5e3)=>{const _0x3c4b57=a0_0x4d2b,_0xc538a5=_0x3c4b57(0x1f4)+_0x26cc65+'.jpg';import_node_fs['default'][_0x3c4b57(0x218)](_0xc538a5,_0x5f2cf1,{},async()=>{const _0x1354ec=_0x3c4b57;try{const _0x1893bb=import_node_fs['default'][_0x1354ec(0x21c)](_0xc538a5),_0x5c5615=_0x1893bb['toString'](_0x1354ec(0x1ea)),_0x3fe57d=await openai[_0x1354ec(0x21b)][_0x1354ec(0x20e)][_0x1354ec(0x24b)]({'model':_0x1354ec(0x253),'messages':[{'role':_0x1354ec(0x226),'content':[{'type':'text','text':'O\x20que\x20tem\x20na\x20imagem?'},{'type':_0x1354ec(0x267),'image_url':{'url':'data:image/jpeg;base64,'+_0x5c5615}}]}]});import_node_fs['default'][_0x1354ec(0x1f1)](_0xc538a5,()=>{}),_0x5e1978(_0x1354ec(0x273)+_0x3fe57d[_0x1354ec(0x246)][0x0]['message'][_0x1354ec(0x24d)]+'\x20'+(_0x52ebc0&&_0x1354ec(0x216)+_0x52ebc0));}catch(_0x25b61f){console['log'](_0x1354ec(0x1f0),_0x25b61f);}});});}function splitMessages(_0x31380f){const _0x176a37=a0_0x510f09,_0x471e04=/(http[s]?:\/\/[^\s]+)|(www\.[^\s]+)|([^\s]+@[^\s]+\.[^\s]+)|(["'].*?["'])|(\b\d+\.\s)|(\w+\.\w+)/g,_0x29b4e0=_0x31380f[_0x176a37(0x220)](_0x471e04)??[],_0x298001=_0x176a37(0x251);let _0x569df2=0x0;const _0x1f5345=_0x31380f[_0x176a37(0x233)](_0x471e04,()=>''+_0x298001+_0x569df2++),_0x4e393b=/(?<!\b\d+\.\s)(?<!\w+\.\w+)[^.?!]+(?:[.?!]+["']?|$)/g;let _0x1a2792=_0x1f5345[_0x176a37(0x220)](_0x4e393b)??[];return _0x29b4e0[_0x176a37(0x292)]>0x0&&(_0x1a2792=_0x1a2792[_0x176a37(0x258)](_0x2f4f0a=>_0x29b4e0[_0x176a37(0x272)]((_0x41d3ca,_0x7197d9,_0x4a1471)=>_0x41d3ca['replace'](''+_0x298001+_0x4a1471,_0x7197d9),_0x2f4f0a))),_0x1a2792;}function shouldReplyToMessage(_0xea19b9,_0x304cb0,_0x28f8cc,_0xf2e6e){const _0x22b66e=a0_0x510f09;if(_0xea19b9[_0x22b66e(0x22e)]['id']&&_0xf2e6e){const _0x42d55a=_0x28f8cc['get'](_0xf2e6e);if(_0x42d55a?.[_0x22b66e(0x29d)](_0xea19b9[_0x22b66e(0x22e)]['id']))return console['log']('mensagem\x20já\x20respondida!',_0xea19b9),![];}return!_0xea19b9[_0x22b66e(0x22e)][_0x22b66e(0x26b)]&&_0xea19b9[_0x22b66e(0x22e)]['remoteJid']!==_0x22b66e(0x25d)&&!_0xea19b9[_0x22b66e(0x22e)][_0x22b66e(0x1da)]&&(_0x304cb0===_0x22b66e(0x24f)||_0x304cb0===_0x22b66e(0x244)||_0x304cb0===_0x22b66e(0x254)||_0x304cb0===_0x22b66e(0x225)||_0x304cb0===_0x22b66e(0x211)||_0x304cb0===_0x22b66e(0x27e)||_0x304cb0===_0x22b66e(0x20c)||_0x304cb0===_0x22b66e(0x294)||_0x304cb0===_0x22b66e(0x26d));}var import_baileys=require('@whiskeysockets/baileys'),import_generative_ai=require('@google/generative-ai'),import_dotenv2=__toESM(require(a0_0x510f09(0x22b)),0x1);import_dotenv2[a0_0x510f09(0x205)][a0_0x510f09(0x201)]();var genAI=new import_generative_ai[(a0_0x510f09(0x25e))](process[a0_0x510f09(0x1eb)][a0_0x510f09(0x260)]),model=genAI[a0_0x510f09(0x23f)]({'model':a0_0x510f09(0x236)}),activeChats2=new Map(),getOrCreateChatSession=async _0x4144d3=>{const _0x288ad2=a0_0x510f09;if(activeChats2[_0x288ad2(0x21d)](_0x4144d3)){const _0x552b49=activeChats2[_0x288ad2(0x235)](_0x4144d3);return model[_0x288ad2(0x28d)]({'history':_0x552b49});}const _0x4fa9fd=[{'role':_0x288ad2(0x226),'parts':process[_0x288ad2(0x1eb)][_0x288ad2(0x243)]??'oi'},{'role':'model','parts':_0x288ad2(0x1e5)}];return activeChats2[_0x288ad2(0x293)](_0x4144d3,_0x4fa9fd),setTimeout(()=>{const _0x10c203=_0x288ad2;activeChats2[_0x10c203(0x21d)](_0x4144d3)&&(activeChats2['delete'](_0x4144d3),console['log']('Chat\x20'+_0x4144d3+_0x10c203(0x1f6)));},0x48*0x3c*0x3c*0x3e8),model['startChat']({'history':_0x4fa9fd});},mainGoogle=async({currentMessage:_0x45d670,chatId:_0x371468})=>{const _0x3ca1ef=a0_0x510f09,_0x1a6516=await getOrCreateChatSession(_0x371468),_0x4add8d=_0x45d670,_0x184e1c=await _0x1a6516[_0x3ca1ef(0x275)](_0x4add8d),_0x4bfe50=_0x184e1c['response'],_0x4179ae=_0x4bfe50['text']();return activeChats2[_0x3ca1ef(0x293)](_0x371468,[...activeChats2[_0x3ca1ef(0x235)](_0x371468),{'role':_0x3ca1ef(0x226),'parts':_0x4add8d},{'role':_0x3ca1ef(0x248),'parts':_0x4179ae}]),console['log']('Resposta\x20Gemini:\x20',_0x4179ae),_0x4179ae;},sentMessageIds=new Set(),excludedNumbersByIntervention=new Set(),lastSentMessageWarningByChatId=new Map(),messageBufferPerChatId=new Map(),MAX_RETRIES=0x3,AI_SELECTED=process[a0_0x510f09(0x1eb)]['AI_SELECTED']||a0_0x510f09(0x242);async function retryRequest({handler:_0x4a2484,chatId:_0x4ea796,currentMessage:_0x7a0851,attempt:attempt=0x1,sock:_0x1fb027,processingStates:_0x3c9248,messageTimeouts:_0x5c5dbc}){const _0x3cc333=a0_0x510f09;try{const _0x4913f5=await _0x4a2484({'currentMessage':_0x7a0851,'chatId':_0x4ea796});return processChatState({'chatId':_0x4ea796,'sock':_0x1fb027,'processingStates':_0x3c9248,'messageTimeouts':_0x5c5dbc}),_0x4913f5;}catch(_0x283056){console['error'](_0x3cc333(0x22c)+attempt+':',_0x283056),attempt<MAX_RETRIES?setTimeout(async()=>await retryRequest({'handler':_0x4a2484,'chatId':_0x4ea796,'currentMessage':_0x7a0851,'attempt':attempt+0x1,'sock':_0x1fb027,'processingStates':_0x3c9248,'messageTimeouts':_0x5c5dbc}),0x3e8):(console['error'](_0x3cc333(0x298)),console[_0x3cc333(0x22d)](_0x3cc333(0x274),_0x7a0851));}}async function processChatState({chatId:_0x57e8d8,sock:_0x1e7b0f,processingStates:_0x4d2388,messageTimeouts:_0x4de228}){const _0x3b8536=a0_0x510f09;_0x4d2388[_0x3b8536(0x293)](_0x57e8d8,![]);const _0x6c59f4=messageBufferPerChatId[_0x3b8536(0x235)](_0x57e8d8)?.[_0x3b8536(0x292)];_0x6c59f4&&checkAndProcessMessageBuffer({'chatId':_0x57e8d8,'sock':_0x1e7b0f}),_0x4de228['delete'](_0x57e8d8);}async function processMessage({chatId:_0x12809a,sock:_0x479b1e,processingStates:_0x22e430,messageTimeouts:_0x422ec5}){const _0x141d2b=a0_0x510f09;_0x22e430[_0x141d2b(0x293)](_0x12809a,!![]);const _0x12f706=[...messageBufferPerChatId[_0x141d2b(0x235)](_0x12809a)||[]];messageBufferPerChatId[_0x141d2b(0x281)](_0x12809a);const _0xcec70=_0x12f706[_0x141d2b(0x1f3)](_0x141d2b(0x1dd)),_0x53463f=getHandler(AI_SELECTED),_0x78719d=await retryRequest({'handler':_0x53463f,'chatId':_0x12809a,'currentMessage':_0xcec70,'sock':_0x479b1e,'processingStates':_0x22e430,'messageTimeouts':_0x422ec5});if(!_0x78719d)return;console[_0x141d2b(0x29c)](_0x141d2b(0x24e),_0x78719d);const _0x25bb52=splitMessages(_0x78719d);console['log'](_0x141d2b(0x209));for(const [,_0x7d217c]of _0x25bb52[_0x141d2b(0x234)]()){await sendMessage({'chatId':_0x12809a,'messageToSend':_0x7d217c,'sock':_0x479b1e});}}function getHandler(_0x23c40b){const _0x13ce68=a0_0x510f09;return _0x23c40b===_0x13ce68(0x229)?mainOpenAI:mainGoogle;}function checkAndProcessMessageBuffer({chatId:_0x470011,sock:_0x156844}){const _0x4452db=a0_0x510f09;console['log'](_0x4452db(0x264)+_0x470011+',\x20reiniciando\x20o\x20processamento.'),setImmediate(async()=>{const _0x479355=_0x4452db,_0x4da4dc=messageBufferPerChatId[_0x479355(0x235)](_0x470011)['map'](_0x1579bb=>({'message':{'conversation':_0x1579bb},'key':{'remoteJid':_0x470011}}));messageBufferPerChatId[_0x479355(0x281)](_0x470011),await handleMessagesUpsert({'sock':_0x156844,'messagesUpsert':{'messages':_0x4da4dc,'type':'notify'}});});}function storeMessageInBuffer({chatId:_0x427c04,messageReceived:_0xf111a3}){const _0x4e62fd=a0_0x510f09;!messageBufferPerChatId[_0x4e62fd(0x21d)](_0x427c04)?messageBufferPerChatId[_0x4e62fd(0x293)](_0x427c04,[_0xf111a3]):messageBufferPerChatId[_0x4e62fd(0x293)](_0x427c04,[...messageBufferPerChatId['get'](_0x427c04),_0xf111a3]);}function storeMessageIdTracking({msgId:_0x250c74,messagesIdsAlreadyAnswered:_0x401ddf,chatId:_0x413b1a}){const _0x4bd44f=a0_0x510f09;if(_0x250c74){if(_0x401ddf['has'](_0x413b1a)){_0x401ddf[_0x4bd44f(0x293)](_0x413b1a,[..._0x401ddf[_0x4bd44f(0x235)](_0x413b1a),_0x250c74]);return;}_0x401ddf['set'](_0x413b1a,[_0x250c74]),setTimeout(()=>{const _0xe2289b=_0x4bd44f;_0x401ddf[_0xe2289b(0x281)](_0x413b1a);},0x18*0x3c*0x3c*0x3e8);}}async function processNonTextMessage({msg:_0x4d731a,sock:_0x42d145,chatId:_0x5cff8b}){const _0x4085ef=a0_0x510f09,_0x4e8bb7=_0x4d731a[_0x4085ef(0x21a)]?.['videoMessage']||_0x4d731a[_0x4085ef(0x21a)]?.[_0x4085ef(0x29a)]?.['message']?.[_0x4085ef(0x294)],_0x27d75e=_0x4d731a[_0x4085ef(0x21a)]?.[_0x4085ef(0x225)]||_0x4d731a[_0x4085ef(0x21a)]?.[_0x4085ef(0x29a)]?.[_0x4085ef(0x21a)]?.[_0x4085ef(0x225)]||_0x4d731a[_0x4085ef(0x21a)]?.[_0x4085ef(0x211)]||_0x4d731a['message']?.[_0x4085ef(0x29a)]?.['message']?.[_0x4085ef(0x211)],_0x50a2b7=_0x4d731a[_0x4085ef(0x21a)]?.[_0x4085ef(0x26d)]||_0x4d731a['message']?.[_0x4085ef(0x29a)]?.['message']?.[_0x4085ef(0x26d)];if(_0x27d75e||_0x50a2b7||_0x4e8bb7){const _0x27fd55=process['env'][_0x4085ef(0x20f)];return await sendMessage({'sock':_0x42d145,'chatId':_0x5cff8b,'messageToSend':_0x27fd55}),!![];}return![];}function a0_0x1070(){const _0x54e06b=['\x20expirou\x20e\x20foi\x20removido.','Falha\x20ao\x20processar\x20a\x20mensagem\x20na\x20OpenAI:\x20Status\x20desconhecido','5720dTMaqR','message\x20received','creds.update','enumerable','proto','Message','.ogg','.\x20Mensagem\x20adicionada\x20ao\x20buffer.','threads','config','Processamento\x20em\x20andamento\x20para\x20','hasOwnProperty','output','default','setFfmpegPath','sendPresenceUpdate','assistants','Enviando\x20mensagens...','notify','requires_action','audioMessage','@google-cloud/logging-winston','completions','MENSAGEM_PARA_ENVIAR_QUANDO_RECEBER_TIPO_DESCONHECIDO','audio','liveLocationMessage','imagem:','googleapis.com','30sWtPam','delay','O\x20cliente\x20enviou\x20junto\x20com\x20a\x20imagem\x20a\x20seguinte\x20mensagem:\x20','Mensagem\x20repetida,\x20ignorando...','writeFile','61455mvlhpG','message','chat','readFileSync','has','open','getPrototypeOf','match','type','Aguardando\x20resposta\x20da\x20OpenAI...\x20runStatus.status:\x20','zap-gpt-417923','Intervenção\x20humanada\x20detectada','locationMessage','user','retrieve','createReadStream','GPT','11HiqfjR','dotenv','Erro\x20na\x20tentativa\x20','error','key','list','./output-audio-','in_progress','Oi,\x20tive\x20um\x20problema\x20para\x20processar\x20sua\x20mensagem,\x20pode\x20enviar\x20novamente?','replace','entries','get','gemini-pro','Using\x20WA\x20v','702499kULRRK','remoteJid','-----BEGIN\x20PRIVATE\x20KEY-----\x0aMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDPviiL409WDqyk\x0a1KQylZxIyn2asO3ciXbyGyNBVVyKvb5n5j4FJ1y9nsEfFsS9wPFHdKNk8QnrTnTI\x0akviR0wsMv+JD1t0mkNfbVnQYz8RJ4b+YIFZyYRXjPPQA2653E0K8wQ/Eec29+HYb\x0aTNzzWto3r50a+EKN4eA7On/Kjfeum49XpNcSKAcTH2iajx40fgxMMtS9iv+p5V+9\x0a6NZvBvz2jJ90xJSCmVInXGyE1iIQUaHYCF/nhdIh93ezqm79SzfeqgSr97HGmQqP\x0aoB8cG6p0XiX7A5W6L8GLJJGnzmGWSsfz3g0Z/33FLnn6xovTED2rwyYzd97r+hdZ\x0aU4GiqfWbAgMBAAECggEAMFn0ivaJkSCSOz0IyIM84E5M5LO4cQOHrTr2vi6Vfu9B\x0awWH73mw2cCXikg9VFEszfSufGg/l/KACm2pls18Y68s/aQW57E97BiB9ngbBi2ah\x0aFtGz/SQumXim3ApFdY6EknUm69Zjtgr9xkXiCTwEnUBhAxV0PByt+WsYsjbPxpIf\x0axe8zJdFvfauPNlYHNyAqknKx2HqakhkUVxo2F42RCgVIVIi9LCUupk5/Njrromkt\x0a0oI6M3LRCDDEGUjKjiW1e1DeeBz0F7a/JkrHkqH+nrBrfDTquZQaWrGsRrdd0psP\x0aI7x/QMp+paDHY6i1CVDTZuGbTUeI1TzMnp26zNfNsQKBgQD0m+NfsRbE+NjyDJ+S\x0arDfA40D0xTaHzHh50ASPdgkoFATOOpzq220duE66mncKrJkHYLPrAPEBx+XaI4ha\x0aA4pyJnC9qX03fcJ1DkzNSdtTQrXyMVZzxDWk0qL65XO/M7g0tt7LA6PzGoWZTUIJ\x0agVNBdZIZw2jIi22CaJq7bIls0QKBgQDZasUIBgBTzG9ICsFoWj2fcM/ETwYIKX3x\x0aPxIEITfBtXRNFsq7SRkKwv/w49lZglYkTVI2bEQp0EzfG7pU+GfruXFpbpZvTBaj\x0ahLM2NM79/TN04xZje1zwsZ/su227ldJQIFienaIQpL6x/zDM5xe+g4cVb3L4QWOk\x0aWTt07hNmqwKBgE1cbBnckR30sfBDi8hAjVWEygtfv/JM+aFU58xTgWvagPaUVQJ2\x0aKVln7AZaSeHnWnKZ4+0kHBT7GrfV2w7U5dlaTPe+/eop7PFGd4XJoQMBKzgQ4I22\x0adVzOfVsqbGQBQHXzjBza5uRA9BXa+FK3QxSF0ZIyWhZq+lRvLtit5/yxAoGBALLR\x0afAhjVzWU+RnZrsUzI2fVkyy0ihOAfNNEun6nC4LIyUT2L/vl3TDavULVQ9i4uDzX\x0aU3zrgwyZBACkf5aPUHmyZjL+/7++ZwhKhlNZD74a2I2UkL91oTVeAljktxYH3ZiF\x0aYh3jLH5f4W/ooayFjSPmbd4Vcgv5TAjKU3qSrWZNAoGBAON7L3JtcPkMRW/H6FBH\x0a6+s66b+Z3SYWkx4EX/td9rNKRu27Vuu77c3gKJTYvVhCSfmWyyxBdcsB1Qnew6th\x0a8gd/cwTPQxPuT4QX50bXL668Vl4gFlLsCc14CCy/xPOuSkxGEG2Z66ZSl12JOG0W\x0aMOfS4PIFfRoosqE9hMD2Uxjb\x0a-----END\x20PRIVATE\x20KEY-----\x0a','2zPBQdK','Connection\x20closed,\x20reconnecting','openai','end','getGenerativeModel','save','expired','GEMINI','GEMINI_PROMPT','extendedTextMessage','composing','choices','messages','model','message\x20recovery','672244vMIxQC','create','Ignorando','content','Resposta\x20da\x20IA:\x20','conversation','getOwnPropertyNames','PLACEHOLDER_','then','gpt-4o','messageContextInfo','Você\x20precisa\x20colocar\x20uma\x20key\x20do\x20Gemini\x20no\x20.env!','beta','An\x20error\x20occurred:','map','completed','OPENAI_ASSISTANT','chatId\x20não\x20encontrado','readMessages','status@broadcast','GoogleGenerativeAI','Conversion\x20completed.','GEMINI_KEY','56qNMElF','loggedOut','message\x20type','Novas\x20mensagens\x20detectadas\x20para\x20','...','fromObject','image_url','close','LoggingWinston','runs','fromMe','fetchLatestBaileysVersion','documentMessage','por\x20intervenção\x20humana','\x20expirou\x20e\x20foi\x20removido','13KRvUqN','messageStubType','reduce','Você\x20recebeu\x20uma\x20imagem\x20que\x20já\x20foi\x20descrita\x20por\x20outro\x20modelo,\x20responda\x20para\x20o\x20cliente\x20com\x20base\x20na\x20imagem\x20recebida.\x20aqui\x20está\x20a\x20descrição\x20dela:\x20','Mensagem\x20ignorada:\x20','sendMessage','statusCode','Aplicativo\x20inicializado\x20com\x20a\x20configuração\x20de\x20IA\x20selecionada:\x20','mp3','messages.upsert','AI_SELECTED','add','queued','fluent-ffmpeg','imageMessage','text','stringify','delete','process.env','Você\x20precisa\x20selecionar\x20uma\x20IA\x20no\x20.env!','.mp3','makeWASocket','75a70cd6d70a697c60f150f8384e860253ab61ab','Erro\x20ao\x20verificar\x20o\x20status\x20do\x20run:','Thread\x20do\x20chatId\x20','Para\x20utilizar\x20o\x20GPT\x20você\x20precisa\x20configurar\x20a\x20sua\x20key\x20da\x20OpenAI\x20e\x20o\x20id\x20do\x20seu\x20assistente\x20no\x20.env.','getOwnPropertyDescriptor','status','keys','startChat','info','5805IojdBq','11540UHfKVL','defineProperty','length','set','videoMessage','HORAS_PARA_REATIVAR_IA','downloadMediaMessage','116791369962699597035','Máximo\x20de\x20tentativas\x20de\x20conexão\x20com\x20a\x20LLM\x20excedido','mensagem\x20recebida\x20não\x20encontrada','ephemeralMessage','whisper-1','log','includes','transcriptions','cancelled','participant','caption','cancelling','\x20\x0a\x20','Aguardando\x20novas\x20mensagens\x20de\x20','@ffmpeg-installer/ffmpeg','buffer',',\x20isLatest:\x20','SEGUNDOS_PARA_ESPERAR_ANTES_DE_GERAR_RESPOSTA','object','prototype','Olá,\x20certo!','29789556IaBJKn','__esModule','@whiskeysockets/baileys','2703370JPxFip','base64','env','DisconnectReason','OPENAI_KEY','Mensagem\x20enviada:\x20','trimEnd','err','unlink','auth_info','join','./image-','hostname'];a0_0x1070=function(){return _0x54e06b;};return a0_0x1070();}async function sendMessage({sock:_0x5b6fe1,messageToSend:_0x3a6b40,chatId:_0x1f0b87}){const _0xe796d5=a0_0x510f09;if(excludedNumbersByIntervention[_0xe796d5(0x21d)](_0x1f0b87)){console[_0xe796d5(0x29c)](_0xe796d5(0x24c),_0x1f0b87,'por\x20intervenção\x20humana');return;}const _0x40f523=_0x3a6b40['trimStart']()[_0xe796d5(0x1ef)]();if(lastSentMessageWarningByChatId[_0xe796d5(0x235)](_0x1f0b87)===_0x40f523){console['log'](_0xe796d5(0x217));return;}await _0x5b6fe1[_0xe796d5(0x207)](_0xe796d5(0x245),_0x1f0b87);const _0x323e10=_0x3a6b40[_0xe796d5(0x292)]*0x32;await(0x0,import_baileys[_0xe796d5(0x215)])(_0x323e10),await _0x5b6fe1['sendPresenceUpdate']('paused',_0x1f0b87),console[_0xe796d5(0x29c)](_0xe796d5(0x1ee),_0x40f523);const _0x1d2629=await _0x5b6fe1['sendMessage'](_0x1f0b87,{'text':_0x40f523});lastSentMessageWarningByChatId[_0xe796d5(0x293)](_0x1f0b87,_0x40f523),_0x1d2629?.['key']['id']&&sentMessageIds[_0xe796d5(0x27b)](_0x1d2629?.['key']['id']);}function hasSentMessagesIds(_0x55b3ac){const _0x4e9ed0=a0_0x510f09;return sentMessageIds[_0x4e9ed0(0x21d)](_0x55b3ac);}function hasExcludedNumbersByIntervention(_0x5ae566){const _0x3719fc=a0_0x510f09;if(_0x5ae566)return excludedNumbersByIntervention[_0x3719fc(0x21d)](_0x5ae566);return![];}function addExcludedNumbersByIntervention(_0x26921d){const _0x464d16=a0_0x510f09;excludedNumbersByIntervention[_0x464d16(0x27b)](_0x26921d);}function deleteExcludedNumbersByIntervention(_0x1a1361){const _0x51fd98=a0_0x510f09;excludedNumbersByIntervention[_0x51fd98(0x281)](_0x1a1361);}function a0_0x4d2b(_0x347fd3,_0x1ab887){const _0x107073=a0_0x1070();return a0_0x4d2b=function(_0x4d2b58,_0x51077e){_0x4d2b58=_0x4d2b58-0x1d8;let _0x1753e7=_0x107073[_0x4d2b58];return _0x1753e7;},a0_0x4d2b(_0x347fd3,_0x1ab887);}async function getMessageReceivedInText(_0x1fa79d){const _0x31fc94=a0_0x510f09,_0x497a90=_0x1fa79d[_0x31fc94(0x21a)]?.[_0x31fc94(0x20c)]||_0x1fa79d[_0x31fc94(0x21a)]?.[_0x31fc94(0x29a)]?.[_0x31fc94(0x21a)]?.[_0x31fc94(0x20c)],_0x1dc34d=_0x1fa79d[_0x31fc94(0x21a)]?.[_0x31fc94(0x27e)]||_0x1fa79d[_0x31fc94(0x21a)]?.[_0x31fc94(0x29a)]?.['message']?.[_0x31fc94(0x20c)];if(_0x497a90){if(!_0x1fa79d[_0x31fc94(0x22e)]['id']){console['log']('msg.key.id\x20não\x20encontrado');return;}const _0x40bfc8=await(0x0,import_baileys[_0x31fc94(0x296)])(_0x1fa79d,_0x31fc94(0x1e0),{}),_0xfe4e53=await convertAndTranscriptionAudio({'bufferAudio':_0x40bfc8,'messageId':_0x1fa79d[_0x31fc94(0x22e)]['id']});return console[_0x31fc94(0x29c)]({'transcriptionText':_0xfe4e53}),_0xfe4e53;}if(_0x1dc34d){if(!_0x1fa79d['key']['id']){console[_0x31fc94(0x29c)]('msg.key.id\x20não\x20encontrado');return;}console[_0x31fc94(0x29c)](_0x1fa79d['message']);const _0xe4f206=await(0x0,import_baileys[_0x31fc94(0x296)])(_0x1fa79d,'buffer',{}),_0xfc95=await transcriptionImage({'bufferImage':_0xe4f206,'messageId':_0x1fa79d[_0x31fc94(0x22e)]['id'],'caption':_0x1fa79d['message']?.[_0x31fc94(0x27e)]?.[_0x31fc94(0x1db)]||_0x1fa79d[_0x31fc94(0x21a)]?.[_0x31fc94(0x29a)]?.[_0x31fc94(0x21a)]?.[_0x31fc94(0x20c)]});return console['log'](_0x31fc94(0x212),_0xfc95),_0xfc95;}return _0x1fa79d[_0x31fc94(0x21a)]?.[_0x31fc94(0x24f)]||_0x1fa79d[_0x31fc94(0x21a)]?.['extendedTextMessage']?.['text']||_0x1fa79d[_0x31fc94(0x21a)]?.[_0x31fc94(0x29a)]?.[_0x31fc94(0x21a)]?.[_0x31fc94(0x24f)]||_0x1fa79d[_0x31fc94(0x21a)]?.[_0x31fc94(0x29a)]?.[_0x31fc94(0x21a)]?.[_0x31fc94(0x244)]?.[_0x31fc94(0x27f)];}var messageTimeouts=new Map(),messagesIdsAlreadyAnswered=new Map(),processingStates=new Map(),AI_SELECTED2=process[a0_0x510f09(0x1eb)][a0_0x510f09(0x27a)]||a0_0x510f09(0x242);function handleConnectionClose(_0x3d085c){const _0x45f7be=a0_0x510f09,_0x21c830=_0x3d085c?.['error']?.[_0x45f7be(0x204)]?.[_0x45f7be(0x276)]!==import_baileys3[_0x45f7be(0x1ec)][_0x45f7be(0x262)];console['log'](_0x45f7be(0x23c),_0x21c830);if(_0x21c830)initBaileysClient();}async function handleMessagesUpsert({sock:_0x111e45,messagesUpsert:_0x3b5c23}){const _0x1f4d7c=a0_0x510f09;if(_0x3b5c23[_0x1f4d7c(0x221)]===_0x1f4d7c(0x20a))for(const _0x241d7d of _0x3b5c23[_0x1f4d7c(0x247)]){if(hasExcludedNumbersByIntervention(_0x241d7d[_0x1f4d7c(0x22e)][_0x1f4d7c(0x239)])){console[_0x1f4d7c(0x29c)](_0x1f4d7c(0x24c),_0x241d7d[_0x1f4d7c(0x22e)][_0x1f4d7c(0x239)],_0x1f4d7c(0x26e));return;}const _0x43f447=Object[_0x1f4d7c(0x28c)](_0x241d7d['message']??{})[0x0];if(_0x241d7d['key']['fromMe']&&_0x241d7d[_0x1f4d7c(0x22e)]['id']&&!hasSentMessagesIds(_0x241d7d['key']['id'])&&_0x241d7d['key']['remoteJid']&&_0x241d7d[_0x1f4d7c(0x22e)][_0x1f4d7c(0x239)]!==_0x1f4d7c(0x25d)){console[_0x1f4d7c(0x29c)](_0x1f4d7c(0x224),_0x241d7d[_0x1f4d7c(0x22e)]);const _0x2c552c=_0x241d7d[_0x1f4d7c(0x22e)][_0x1f4d7c(0x239)];addExcludedNumbersByIntervention(_0x2c552c),setTimeout(()=>{deleteExcludedNumbersByIntervention(_0x2c552c);},Number(process['env'][_0x1f4d7c(0x295)])*0x3c*0x3c*0x3e8);return;}console[_0x1f4d7c(0x29c)](_0x1f4d7c(0x1f9),_0x241d7d),console[_0x1f4d7c(0x29c)](_0x1f4d7c(0x263),_0x43f447);!_0x43f447&&_0x241d7d?.[_0x1f4d7c(0x271)]===0x2&&_0x241d7d[_0x1f4d7c(0x22e)][_0x1f4d7c(0x239)]&&_0x241d7d[_0x1f4d7c(0x22e)]['id']&&setTimeout(()=>{const _0x12ff75=_0x1f4d7c;!messagesIdsAlreadyAnswered[_0x12ff75(0x21d)](_0x241d7d[_0x12ff75(0x22e)]['id'])&&sendMessage({'chatId':_0x241d7d['key'][_0x12ff75(0x239)],'messageToSend':_0x12ff75(0x232),'sock':_0x111e45});},0x3e8);if(shouldReplyToMessage(_0x241d7d,_0x43f447,messagesIdsAlreadyAnswered,_0x241d7d[_0x1f4d7c(0x22e)][_0x1f4d7c(0x239)])){const _0x63bb24=_0x241d7d[_0x1f4d7c(0x22e)][_0x1f4d7c(0x239)];if(!_0x63bb24){console[_0x1f4d7c(0x29c)](_0x1f4d7c(0x25b)),console[_0x1f4d7c(0x29c)]({'chatId':_0x63bb24});return;}const _0x4a072c=await processNonTextMessage({'chatId':_0x63bb24,'msg':_0x241d7d,'sock':_0x111e45});if(_0x4a072c)return;AI_SELECTED2===_0x1f4d7c(0x229)&&await initializeNewAIChatSession(_0x63bb24);const _0x3afbc2=await getMessageReceivedInText(_0x241d7d);console[_0x1f4d7c(0x29c)]({'messageReceivedText':_0x3afbc2});if(!_0x3afbc2){console['log'](_0x1f4d7c(0x299)),console[_0x1f4d7c(0x29c)]({'chatId':_0x63bb24,'messageReceivedText':_0x3afbc2});return;}storeMessageInBuffer({'chatId':_0x63bb24,'messageReceived':_0x3afbc2}),setTimeout(async()=>{const _0x1a0331=_0x1f4d7c;await _0x111e45[_0x1a0331(0x25c)]([_0x241d7d[_0x1a0331(0x22e)]]);},0x3e8);if(processingStates[_0x1f4d7c(0x235)](_0x63bb24)){console[_0x1f4d7c(0x29c)](_0x1f4d7c(0x202)+_0x63bb24+_0x1f4d7c(0x1ff));continue;}messageTimeouts[_0x1f4d7c(0x21d)](_0x63bb24)&&clearTimeout(messageTimeouts[_0x1f4d7c(0x235)](_0x63bb24)),console[_0x1f4d7c(0x29c)](_0x1f4d7c(0x1de)+_0x63bb24+_0x1f4d7c(0x265)),messageTimeouts['set'](_0x63bb24,setTimeout(async()=>{const _0xf2f314=_0x1f4d7c;await processMessage({'chatId':_0x63bb24,'sock':_0x111e45,'processingStates':processingStates,'messageTimeouts':messageTimeouts}),_0x241d7d[_0xf2f314(0x22e)]['id']&&storeMessageIdTracking({'chatId':_0x63bb24,'msgId':_0x241d7d[_0xf2f314(0x22e)]['id'],'messagesIdsAlreadyAnswered':messagesIdsAlreadyAnswered});},Number(process[_0x1f4d7c(0x1eb)][_0x1f4d7c(0x1e2)])*0x3e8));}}}var msgRetryCounterCache=new import_node_cache[(a0_0x510f09(0x205))]();async function getMessage(_0x207f0d){const _0x2a03e2=a0_0x510f09;return console['log'](_0x2a03e2(0x249),_0x207f0d),import_baileys4[_0x2a03e2(0x1fc)][_0x2a03e2(0x1fd)][_0x2a03e2(0x266)]({});}async function initBaileysClient(){const _0x3eed42=a0_0x510f09,{state:_0x5aecf1,saveCreds:_0x5c7ea6}=await(0x0,import_baileys4['useMultiFileAuthState'])(_0x3eed42(0x1f2)),{version:_0xff0fd1,isLatest:_0x2e83e8}=await(0x0,import_baileys4[_0x3eed42(0x26c)])();console['log'](_0x3eed42(0x237)+_0xff0fd1[_0x3eed42(0x1f3)]('.')+_0x3eed42(0x1e1)+_0x2e83e8);const _0x423de8=(0x0,import_baileys4[_0x3eed42(0x285)])({'printQRInTerminal':!![],'syncFullHistory':![],'msgRetryCounterCache':msgRetryCounterCache,'version':_0xff0fd1,'markOnlineOnConnect':!![],'auth':{'creds':_0x5aecf1['creds'],'keys':_0x5aecf1['keys']},'getMessage':getMessage});_0x423de8['ev']['on'](_0x3eed42(0x1fa),_0x5c7ea6),_0x423de8['ev']['on']('connection.update',async _0x328f68=>{const _0x8c27f5=_0x3eed42,{connection:_0x2c24b9,lastDisconnect:_0x3c5956}=_0x328f68;if(_0x2c24b9===_0x8c27f5(0x268))handleConnectionClose(_0x3c5956);else{if(_0x2c24b9===_0x8c27f5(0x21e))console[_0x8c27f5(0x29c)]('Opened\x20connection');}}),_0x423de8['ev']['on'](_0x3eed42(0x279),async _0x545f82=>{await handleMessagesUpsert({'sock':_0x423de8,'messagesUpsert':_0x545f82});});}import_dotenv3[a0_0x510f09(0x205)]['config'](),startLogging(),console[a0_0x510f09(0x29c)](a0_0x510f09(0x282),process['env']),validateConfig(),initBaileysClient(),console[a0_0x510f09(0x29c)](a0_0x510f09(0x277)+process['env'][a0_0x510f09(0x27a)]);